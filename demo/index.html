<!DOCTYPE html>
<!-- saved from url=(0074)http://tools.alipay.im/shanghai/demo/cellula/scenes/itemList/itemList.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>MyApp</title>
    <link charset="utf-8" rel="stylesheet" href="https://a.alipayobjects.com/enterpriseportal/enterpriseportal.base-1.3.css" media="all" />
    <link charset="utf-8" rel="stylesheet" href="https://a.alipayobjects.com/uemprod/uemprod.global-1.3.css" media="all" />
    <link charset="utf-8" rel="stylesheet" href="https://a.alipayobjects.com/uemprod/uemprod.global-1.3-ihome.css" media="all" />
    <link type="text/css" media="screen" charset="utf-8" rel="stylesheet" href="css/base.css">
         <style type="text/css">
         .container {
             padding: 20px;
             background: #fff;
             overflow: hidden;
             width: 990px;
             margin: 0 auto;
         }

         /*
          * common use image
          */
         .title-icon {
             background-image: url("https://i.alipayobjects.com/e/201307/jz3FLxFQ5_src.png");
             background-repeat: no-repeat;
         }
         .myapp-edit, .myapp-link, .myapp-text {
             background-image: url("https://i.alipayobjects.com/e/201307/mgA7yrWlp.png");
             background-repeat: no-repeat;
             background-position: 0 0;
         }
         .myapp-package {
              width: 221px;
              float: left;
              margin: 18px 20px 0 0;
              position: relative;
              border: 1px solid #ddd;
          }

          .myapp-layer {

          }
         .myapp-title-hover {
             background-color: #fafafa;
             cursor: pointer;
         }
          .myapp-layer-hover {
              position: relative;
              margin: -2px -1px -1px;
              background-color: #fafafa;
              border: 1px solid #fab700;
              width: 221px;
              z-index: 9;
              overflow: hidden;
          }
          .myapp-title {
              padding: 0 4px;
              position: relative;
          }
          .myapp-inner-title {
              height: 80px;
              border-bottom: 1px dashed #ddd;
          }

          .title-icon {
              width: 43px;
              height: 42px;
              float: left;
              overflow: hidden;
              margin: 20px 0 0 20px;
          }
          .more-product-icon {
              background-position: -159px -156px;
          }
          .contractmanagement-icon {
              background-position: -212px -208px;
          }




          .title-text {
              float: left;
              margin: 18px 0 0 13px;
          }
         .title-text strong, .title-text em {
             display: block;
         }
         .title-text strong {
             color: #000;
             font-size: 16px;
         }
         .title-text em {
             color: #a6a6a6;
         }
         a.myapp-edit {
             width: 30px;
             height: 30px;
             overflow: hidden;
             position: absolute;
             top: 10px;
             right: 10px;
             text-indent: -99px;
         }
         a.myapp-edit:hover {
             outline: 1px solid #ccc;
         }
          .myapp-edit-icon {
              background-position: 0 -1px;
          }
          .myapp-container {
              position: relative;
              width: 221px;
              overflow: hidden;
          }
          .myapp-container-scroller {
              top: 0;
              left: 0;
              width: 9999px;
              overflow: hidden;
              position: relative;
          }
          .myapp-container-slider {
              float: left;
              width: 221px;
              padding: 10px 0;
              overflow: hidden;
          }
          .myapp-edit-confirm {
              position: absolute;
              right: 8px;
              top: 8px;
          }
           .myapp-item {
               margin-bottom: 4px;
               overflow: hidden;
           }
          .myapp-link {
              font-size: 14px;
              color: #08c;
              height: 30px;
              line-height: 30px;
              padding-left: 10px;
              margin-left: 60px;
              display: inline-block;
              background-position: -206px -71px;
          }
         .myapp-text {
             font-size: 14px;
             height: 30px;
             line-height: 30px;
             padding-left: 10px;
             margin-left: 60px;
             display: block;
             float: left;
             color: #a6a6a6;
             background-position: -4px -71px;
         }

         .unallowDelAppTip, .delAppSuccessTip, .delAppFailedTip {
             top: 0;
             left: 0;
             z-index: 99;
             position: absolute;
             display: none;
         }
         .delAppSuccessTip .mi-tip, .delAppFailedTip .mi-tip {
             margin: 0;
         }
         .unallowDelAppTip .mi-tip-ctn {
             padding: 5px;
         }

         .unallowDelAppTip .mi-tip-cue {
             background: #333;
             border-color: #333;
         }

         .unallowDelAppTip .mi-tip-text {
             color: #fff;
         }

         .unallowDelAppTip .mi-tip-cue .mi-tip-arrow em {
             color: #333;
         }

         .unallowDelAppTip .mi-tip-cue .mi-tip-arrow span {
             color: #333;
         }

         .unallowDelAppTip .mi-tip-arrow-bottom {
             left: 45px;
         }
         .myapp-item .myapp-text {
             margin-right: 0;
         }

         </style>
</head>
<body>

<div class="unallowDelAppTip" id="J_unallowDelAppTip">
    <div class="mi-tip mi-tip-cue">
        <div class="mi-tip-arrow mi-tip-arrow-bottom">
            <em>◆</em>
            <span>◆</span>
        </div>
        <div class="mi-tip-ctn">
            <div class="mi-tip-text">签约产品不可删除</div>
        </div>
    </div>
</div>

<div class="delAppSuccessTip" id="J_delAppSuccess">
    <div class="mi-tip mi-tip-success mi-tip-noicon">
        <div class="mi-tip-ctn">
            <i title="成功" class="iconfont">&#xF049;</i>
            <span>删除成功</span>
        </div>
    </div>
</div>

<div class="delAppFailedTip" id="J_delAppFailed">
    <div class="mi-tip mi-tip-error">
        <div class="mi-tip-ctn">
            <i title="出错" class="iconfont">&#xF045;</i>
            <span>删除错误</span>
        </div>
    </div>
</div>

<div class="container" id="J-container">


</div>

<script type="text/javascript" src="../lib/base/jQuery-1.7.2.js"></script>
<script type="text/javascript" src="../lib/base/cellula.js"></script>
<script type="text/javascript" src="../lib/base/class.js"></script>
<script type="text/javascript" src="../lib/base/util.js"></script>
<script type="text/javascript" src="../lib/base/events.js"></script>
<script type="text/javascript" src="../lib/base/message.js"></script>
<script type="text/javascript" src="../lib/base/cell.js"></script>
<script type="text/javascript" src="../lib/base/element.js"></script>
<script type="text/javascript" src="../lib/base/collection.js"></script>
<script type="text/javascript" src="js/editable-box.js"></script>

<script>
    jQuery.fn.uemSlide = function(opt) {
        // default options
        var defaults        = {
            width           : 221,
            animspeed       : 4000
        };

        var settings        = jQuery.extend({}, defaults, opt);

        // slider elements
        var wrapper        = this,
                slider         = jQuery('.myapp-container-scroller', wrapper),
                slides         = slider.children('ul'),
        // control elements
                c_wrapper      = null,
        // marker elements
                m_wrapper      = null,
                m_markers      = null,
        // elements for slide animation
                clone_first    = null,
                clone_last     = null;

        var state           = {
            slidecount      : slides.length,
            animating       : false,
            paused          : false,
            currentslide    : 1,
            nextslide       : 0,
            currentindex    : 0,
            nextindex       : 0
        };

        var vars            = {
            fwd             : 'forward',
            prev            : 'previous'
        };

        var init = function() {
            if( state.slidecount > 1 ) {
                conf_controls();
                conf_markers();
                conf_slide();
            }
            state.currentindex = 1;
            state.currentslide = 2;
        };

        var conf_slide = function() {
            // create two extra elements which are clones of the first and last slides
            clone_first    = slides.eq(0).clone();
            clone_last     = slides.eq(state.slidecount-1).clone();
            // add them to the DOM where we need them
            clone_first.attr({'data-clone' : 'last', 'data-slide' : 0}).appendTo(slider).show();
            clone_last.attr({'data-clone' : 'first', 'data-slide' : 0}).prependTo(slider).show();
            // update the dimensions to the slider to accomodate all the slides side by side
            slider.css({
                'width'     : settings.width * (state.slidecount + 2),
                'left'      : -settings.width * state.currentslide
            });
            // update the elements object
            slides             = slider.children('ul');
            state.slidecount    = slides.length;
        };

        var conf_controls = function() {
            var control = jQuery('<div class="myapp-slider-trigger"><div class="myapp-slider-trigger-prev" data-direction="previous">←</div><ul class="myapp-slider-trigger-dot"></ul><div class="myapp-slider-trigger-next" data-direction="forward">→</div></div>');
            slider.after(control);
            c_wrapper =  wrapper.find('div.myapp-slider-trigger');
            m_wrapper =  wrapper.find('ul.myapp-slider-trigger-dot');
            // bind click events
            c_wrapper.on('click', 'div', function(e) {
                e.preventDefault();
                var direction = jQuery(this).attr('data-direction');
                if(!state.animating) {
                    if(direction === vars.fwd) {
                        go(vars.fwd, false);
                    }
                    if(direction === vars.prev) {
                        go(vars.prev, false);
                    }
                }
            });
        };

        var conf_markers = function() {
            // for every slide, create a marker
            jQuery.each(slides, function(key, slide){
                var slidenum = key + 1,
                        gotoslide   = key + 2; // + 2 to account for clones

                var marker = jQuery('<li data-num="' + slidenum + '">&bull;</li>');
                // set the first marker to be active
                if(slidenum === state.currentslide){ marker.addClass('current'); }
                // bind the click event
                marker.on('click', function(e) {
                    e.preventDefault();

                    if(!state.animating && state.currentslide !== gotoslide) {
                        go(false, gotoslide);
                    }
                });
                // add the marker to the wrapper
                marker.appendTo(m_wrapper);
                m_markers = c_wrapper.find('li');
            });
        };

        var set_next = function(direction) {
            if(direction === vars.fwd) {
                if(slides.eq(state.currentindex).next().length) {
                    state.nextindex = state.currentindex + 1;
                    state.nextslide = state.currentslide + 1;
                } else {
                    state.nextindex = 0;
                    state.nextslide = 1;
                }
            } else {
                if(slides.eq(state.currentindex).prev().length) {
                    state.nextindex = state.currentindex - 1;
                    state.nextslide = state.currentslide - 1;
                } else {
                    state.nextindex = state.slidecount - 1;
                    state.nextslide = state.slidecount;
                }
            }
        };

        var go = function(direction, position) {
            // only if we're not already doing things
            if(!state.animating) {
                // doing things
                state.animating = true;

                if(position){
                    state.nextslide = position;
                    state.nextindex = position-1;
                } else {
                    set_next(direction);
                }

                var markerindex = state.nextindex-1;

                if(markerindex === state.slidecount-2){
                    markerindex = 0;
                } else if(markerindex === -1) {
                    markerindex = state.slidecount-3;
                }
                //console.log( 'nextindex:' + state.nextindex + ',nextslide：' + state.nextslide);
                m_markers.removeClass('current');
                m_markers.eq(markerindex).addClass('current');

                state.slidewidth = settings.width;

                slider.animate({'left': -state.nextindex * state.slidewidth }, settings.animduration, function() {
                    state.currentslide = state.nextslide;
                    state.currentindex = state.nextindex;
                    // is the current slide a clone?
                    if(slides.eq(state.currentindex).attr('data-clone') === 'last') {
                        // affirmative, at the last slide (clone of first)
                        slider.css({'left': -state.slidewidth });
                        state.currentslide = 2;
                        state.currentindex = 1;
                    } else if(slides.eq(state.currentindex).attr('data-clone') === 'first') {
                        // affirmative, at the fist slide (clone of last)
                        slider.css({'left': -state.slidewidth *(state.slidecount - 2)});
                        state.currentslide = state.slidecount - 1;
                        state.currentindex = state.slidecount - 2;
                    }

                    state.animating = false;
                });
            }
        };

        init();

    };


</script>

<script type="text/javascript">

    var myAppJson = [
        {
            "myappTitle": "更多应用",
            "myappTitleExplain": "为您考虑、更周全",
            "url": 'https://www.alipay.com',
            "isEdit": true,
            "iconCls": 'more-product-icon',
            "myappItem": [{
                "appkey": '5010',
                "icon": '111.png',
                "link": '#',
                "text": '企业版内部转账11',
                "allowDel": true
            }, {
                "appkey": '5009',
                "icon": '222.png',
                "link": '#',
                "text": '提现222',
                "allowDel": true
            },
                {
                    "appkey": '5008',
                    "icon": '33.png',
                    "link": '#',
                    "text": '提现33',
                    "allowDel": false
                },
                {
                    "appkey": '5007',
                    "icon": '444.png',
                    "link": '#',
                    "text": '提现444',
                    "allowDel": true
                },
                {
                    "appkey": '5006',
                    "icon": '555.png',
                    "link": '#',
                    "text": '提现555',
                    "allowDel": false
                }]
        },
        {
            "myappTitle": "签约管理",
            "myappTitleExplain": "在线查询、实时跟进",
            "url": 'https://www.alipay.com',
            "isEdit": true,
            "iconCls": 'contractmanagement-icon',
            "myappItem": [{
                "appkey": '3007',
                "icon": '111.png',
                "link": '#',
                "text": '签约订单',
                "allowDel": false
            }, {
                "appkey": '3008',
                "icon": '222.png',
                "link": '#',
                "text": '我的签约产品',
                "allowDel": true
            }]
        }
    ];

    (function(c) {
        var util = c._util, Class = c.Class, Coll = c.Collection;

        // app数据
        var MyAppItemElement = new Class('MyAppItemElement', {
            init: function(conf) {
                this._super(conf);
                this.set({
                    appkey: conf.appkey,
                    icon: conf.icon,
                    text: conf.text,
                    allowDel: conf.allowDel,
                    textMaxLen: 18,
                    link: conf.link,
                    wrapCls: 'myapp-item',
                    cls: 'myapp-link'
                    //editCls: ''
                });

            }
        }).inherits(c.Element);

        // myapp item
        var MyAppItem = new Class('myAppItem', {
            appItemElement: undefined,  // 数据集
            editingRootNode: undefined,
            init: function(conf, data) {
                if(!this.key) this.key = this.__cid__;
                if(!util.isObject(conf) || util.isEmpty(conf)) return;
                this._super(conf);
                this.appItemElement = new MyAppItemElement(data);
                this.rootNode = this._createItem();
                this._bindAll('delTheApp');
            },
            _createItem: function() {
                var _tpl = '<li class="$-{wrapCls}" appkey="$-{appkey}"><a href="$-{link}" class="$-{cls}">$-{text}</a></li>';
                return jQuery( util.makeTpl(_tpl, {
                    wrapCls: this.appItemElement.get("wrapCls"),
                    appkey: this.appItemElement.get("appkey"),
                    link: this.appItemElement.get("link"),
                    cls: this.appItemElement.get("cls"),
                    text: this.appItemElement.get("text")
                }) );
            },
            _createEditingItem: function() {
                var _tpl = '<li class="$-{wrapCls}" appkey="$-{appkey}"><span class="myapp-text" title="$-{fullText}">$-{text}</span></li>';
                return jQuery( util.makeTpl(_tpl, {
                    wrapCls: this.appItemElement.get("wrapCls"),
                    appkey: this.appItemElement.get("appkey"),
                    text: this.appItemElement.get("text"),
                    fullText: this.appItemElement.get("text")
                }) );
            },
            hoverOn: function() {
                var tip = jQuery('#J_unallowDelAppTip');
                tip.css({
                    left: parseInt(jQuery(this).offset().left + 60, 10),
                    top: parseInt(jQuery(this).offset().top - tip.height() - 5, 10)
                }).show();
            },
            hoverOut: function() {
                jQuery('#J_unallowDelAppTip').css({top:0,left:0}).hide();
            },
            delTheApp: function() {
                // 通知 MyAppList 删除
                // console.log(this.key);
                this.emit('MyAppItem:DELAPP', {
                    appid: this.key,
                    appkey: this.appItemElement.get('appkey')
                });
            },
            // 编辑状态
            editing: function() {
                this.editingRootNode = this._createEditingItem();  // 产出编辑状态的 item node
                if(this.appItemElement.get("allowDel") === false) {
                    // 禁止删除
                    this.editingRootNode.hover(this.hoverOn, this.hoverOut);
                } else {
                    // 允许删除
                    var del = jQuery('<a href="javascript:;" class="myapp-arrow-del fn-right">X</a>');
                    del.click(this.delTheApp);
                    del.appendTo(this.editingRootNode);
                }
            },
            receiver: function(e) {
                if(!e) return;
                var /*targ = e.target, */evt = e.name.split(':')[1];
                switch (evt) {
                    case 'EDITING':
                        this.editing();
                        break;
                }
            }
        }).inherits(c.Cell);

        // MyAppListElement 数据集
        var MyAppListElement = new Class('MyAppListElement', {
            init: function(conf) {
                this._super();
                this.set({
                    title: conf.myappTitle,
                    titleExplain: conf.myappTitleExplain,
                    iconCls: conf.iconCls,
                    isEdit: conf.isEdit,
                    url: conf.url
                });
                //util.log(this.title);
                //this.storage.toStorage(["title", "titleExplain"]);
                //util.log(this._data);
            }
        }).inherits(c.Element);

        var MyAppList = new Class('MyAppList', {
            unitMaxLen: 3, // 每列显示3个item
            unitListColumn: 0,
            collection: undefined,
            myAppItem: undefined,
            wrapNode: '<ul class="myapp-container-slider"></ul>',
            appListElement: undefined, // 数据
            init: function(conf, data) {
                if(!this.key) this.key = this.__cid__;
                if(!util.isObject(conf) || util.isEmpty(conf)) return;
                this._super(conf);
                this.appListElement = new MyAppListElement(data);
                this.rootNode = this._createList();
                this.collection = new Coll({ type: this.myAppItem });
                this._bindAll('editing', 'finished', 'redirect');
                // 获取 appItem 数据
                var appItems = this._getAppItem(data);
                this._createMyAppItem( appItems );
                this.renderMyAppList();
            },
            redirect: function() {
                var url = this.appListElement.get('url');
                url && (window.location.href = url);
            },
            renderMyAppList: function(editing) {
                var nodeKey = editing ? 'editingRootNode' : 'rootNode';
                var i = 0,
                    wrap,
                    cont = jQuery('.myapp-container-scroller', this.rootNode);
                this.emptyWrapNode();
                this.unitListColumn = Math.ceil(this.collection.size() / this.unitMaxLen);  // 列数
                util.each(this.collection.get(), function(obj) {
                    if(i % this.unitMaxLen == 0) {
                        wrap && (wrap = undefined);
                        wrap = jQuery(this.wrapNode);
                    }
                    var nodelist = wrap.append(obj[nodeKey]);
                    if(i % this.unitMaxLen == 0) cont.append(nodelist);
                    i++;
                }, this);

                jQuery('.myapp-title', this.rootNode).hover(function() {
                    jQuery(this).addClass('myapp-title-hover');
                }, function() {
                    jQuery(this).removeClass('myapp-title-hover');
                }).click(this.redirect);
                // 编辑状态？
                editing ? this.editOperate() : this.paging();
            },
            paging: function() {
                if(this.unitListColumn > 1) {
                    jQuery('.myapp-container', this.rootNode).uemSlide({
                        width : 221
                    });
                }
            },
            layerHoverWidth: function(len) {
                var col = Math.ceil(len / this.unitMaxLen);
                return parseInt(col * 221, 10);
            },
            editOperate: function() {
                // 移除title hover
                jQuery('.myapp-title', this.rootNode).removeClass('myapp-title-hover');
                jQuery('.myapp-title', this.rootNode).unbind('mouseenter').unbind('mouseleave');
                // 移除title click
                jQuery('.myapp-title', this.rootNode).unbind('click');
                jQuery('.myapp-slider-trigger', this.rootNode).remove(); // 移除分页
                jQuery('.myapp-container-scroller', this.rootNode).removeAttr('style');
                jQuery('.myapp-edit', this.rootNode).addClass('fn-hide');
                jQuery('.myapp-layer', this.rootNode).addClass('myapp-layer-hover');
                var _tpl = '<div class="myapp-edit-confirm"><span class="mi-button mi-button-sgreen"><button class="mi-button-text">完成</button></span></div>';
                var node = jQuery(_tpl);
                node.click(this.finished);
                jQuery('.myapp-layer-hover', this.rootNode).append(node);
                // layer
                jQuery('.myapp-layer-hover', this.rootNode).css('width', this.layerHoverWidth(this.collection.size()));
                jQuery('.myapp-container', this.rootNode).css('overflow', 'visible');
            },
            enabledEdit: function() {
                var edit = jQuery('<a href="javascript:;" class="myapp-edit myapp-edit-icon">可编辑</a>');
                if(this.appListElement.get('isEdit')) {
                    jQuery('.myapp-title', this.rootNode).append(edit);
                    edit.click(this.editing);
                }
            },
            delApp: function() {
                var self = this,
                    appid = arguments[0],
                    appkey = arguments[1];
                // 删除ok
               // console.log(this.collection.get())
                var the = this.collection.get(appid);
                // 显示效果
                jQuery('#J_delAppSuccess').clone().appendTo('body').css({
                    left: parseInt(the.editingRootNode.offset().left + 60, 10),
                    top: parseInt(the.editingRootNode.offset().top, 10)
                }).show().fadeOut(500, function() {
                    jQuery(this).remove();
                    the.unfollow(this);
                    self.collection.remove(appid);
                    self.editing(); // 重新渲染
                });
                // 删除失败

            },
            finished: function() {
                this.renderMyAppList();
                jQuery('.myapp-edit', this.rootNode).removeClass('fn-hide');
                jQuery('.myapp-edit-confirm', this.rootNode).remove();
                jQuery('.myapp-container', this.rootNode).removeAttr('style');
                jQuery('.myapp-layer', this.rootNode).removeClass('myapp-layer-hover').removeAttr('style');
            },
            editing: function() {
                if(arguments[0]) {
                    arguments[0].preventDefault();
                    arguments[0].stopPropagation();
                }
                // 通知 appItem 进入编辑状态
                this.emit('MyAppList:EDITING');
                this.renderMyAppList('editing');
            },
            emptyWrapNode: function() {
                jQuery('.myapp-container-scroller', this.rootNode).empty();
            },
            // 获取 myappItem 数据
            _getAppItem: function(obj) {
                return (obj && obj.myappItem) || [];
            },
            addMyAppItem: function(item) {
                item.follow(this);
                this.follow(item);
                this.collection.push(item);
            },
            // 构建 MyAppItem
            _createMyAppItem: function(items) {
                var _myAppItem, keyid = 1;
                util.each(items, function(obj) {
                    _myAppItem = new this.myAppItem({
                        key: 'MyAppItem' + keyid++
                    }, obj);
                    this.addMyAppItem(_myAppItem);
                }, this);
            },
            _createList: function() {
                var _tpl = '<div class="myapp-package fn-clear">' +
                           '<div class="myapp-layer">' +
                           '<div class="myapp-title">' +
                           '<h1 class="myapp-inner-title">' +
                           '<span class="title-icon $-{iconCls}"></span>' +
                           '<span class="title-text">' +
                           '<strong>$-{title}</strong>' +
                           '<em>$-{titleExplain}</em>' +
                           '</span>' +
                           '</h1>' +
                           //'<a href="javascript:;" class="myapp-edit myapp-edit-icon">可编辑</a>' +
                           '</div>' +
                           '<div class="myapp-container">' +
                           '<div class="myapp-container-scroller">' +
                           '</div>' +
                           '</div>' +
                           '</div>' +
                           '</div>';

                return jQuery( util.makeTpl(_tpl, {
                    title: this.appListElement.get("title"),
                    titleExplain: this.appListElement.get("titleExplain"),
                    iconCls: this.appListElement.get('iconCls')
                }) );
            },
            receiver: function(e) {
                if(!e) return;
                var targ = e.target, evt = e.name.split(':')[1];
                switch (evt) {
                    case 'READY':
                        this.enabledEdit(); // 激活编辑
                        this.emit('MyAppList:RENDER', this.rootNode);  // 通知 MyApp 渲染
                        break;
                    case 'DELAPP':
                        this.delApp(arguments[1]['appid'], arguments[1]['appkey']);
                }
            }
        }).inherits(c.Cell);

        var MyApp = new Class('MyApp', {
            container: '#J-container',
            myAppItem: undefined,
            myAppList: undefined,  // 我的应用列表
            collectioin: undefined,
            myAppJson: undefined,
            init: function(conf) {
                if(!util.isObject(conf) || util.isEmpty(conf)) return;
                this._super(conf);
                this.collectioin = new Coll({type: this.myAppList});
                this._createMyAppList();
                this.render();
            },
            render: function() {
                this.emit('MyApp:READY'); // 通知 MyAppList 准备
            },
            _createMyAppList: function() {
                var appList;
                util.each(this.myAppJson, function(obj) {
                    // 构造 myAppList
                    appList = new this.myAppList({
                        myAppItem: this.myAppItem
                    }, obj);
                    this.addMyAppList(appList);
                }, this);
            },
            addMyAppList: function(list) {
                list.follow(this);
                this.follow(list);
                this.collectioin.push(list);
            },
            receiver: function(e) {
                if(!e) return;
                var targ = e.target, evt = e.name.split(':')[1];
                switch (evt) {
                    case 'RENDER':
                        jQuery(this.container).append(arguments[1]);
                        break;
                }
            }
        }).inherits(c.Cell);

        c.MyApp = MyApp;
        c.MyAppList = MyAppList;
        c.MyAppItem = MyAppItem;

    })(Cellula);

    var MyApp = new Cellula.MyApp({
        key: 'MyApp',
        myAppJson: myAppJson,
        myAppList: Cellula.MyAppList,
        myAppItem: Cellula.MyAppItem
    });


</script>

</body>

</html>